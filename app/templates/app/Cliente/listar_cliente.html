{% extends 'app/base.html' %}

{% block js %}
    <script>
        function eliminarCliente(id){
            Swal.fire({
                "title": "Â¿Estas Seguro?",
                "text": "Que deseas Eliminar este Cliente",
                "icon": "warning", 
                "showCancelButton": true,
                "cancelButtonText": "Cancelar",
                "confirmButtonText": "Eliminar",
                "reverseButtons": true,
                "confirmButtonColor": "#dc3545"
            })
            .then(function(result){
                if(result.isConfirmed){
                    window.location.href = "/eliminar-cliente/"+id+"/"
                }
            })
        }
    </script>
{% endblock %}

{% block contenido %}
 
<main class="mt-5 pt-3">
  <div class="container-fluid">

    <h2 style="color: black;">Historial Cliente</h2>
    {% if perms.app.add_cliente %}
      <a href="{% url 'agregar_cliente' %}" class="btn btn-primary">Agregar Cliente</a>
    {% endif %}
    <hr>
    <form class="d-flex col-md-8"">
      <input class="form-control me-2 light-table-filter " data-table="table_id" type="text" placeholder="Buscar con JAVA">
    </form>
    <br>
    <div class="table-responsive">
      <table class="table table-hover">
        <thead >
          <tr>
            <th>Rut</th>
            <th>Nombre</th>
            <th>Apellido Paterno</th>
            <th>Apellido Materno</th>
            <th>Correo</th>
            <th>Telefono</th>
            <th>Opciones</th>
          </tr>
        </thead>
        {% for p in entity %}
          <tbody>
            <tr>
              <td>{{ p.rut_cliente  }}</td>
              <td>{{ p.nombre_cliente  }}</td>
              <td>{{ p.apePaterno  }}</td>
              <td>{{ p.apeMaterno  }}</td>
              <td>{{ p.email  }}</td>
              <td>{{ p.fono   }}</td>
              {% if perms.app.change_cliente %}
                <td>
                  <a href="{% url 'modificar_cliente' p.rut_cliente %}" class="btn btn-info btn-sm">Modificar</a>
                </td>
              {% endif %}
                
              <td><a href="{% url 'historial_cliente' p.rut_cliente %}" class="btn btn-secondary btn-sm">Historial</a></td>
              {% if perms.app.delete_cliente %}
                <td>
                  <a href="#" onclick="eliminarCliente({{p.rut_cliente}})" class="btn btn-danger btn-sm">Eliminar</a>
                </td>
              {% endif %}
      </tr>
          </tbody>
        {% endfor %}
      </table>
    </div>
    <div>
      {% include 'app/paginator.html' %}
    </div>


  </div>  
</div>  
</main>              
{% endblock %}